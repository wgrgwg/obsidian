### GAN의 기본 개념
- 두개의 인공신경망으로 구성 (서로 적대적)
	1. **생성자** : 실제와 유사한 데이터 생성
	2. **판별자** : 주어진 데이터 실제/가짜 구별

- 적대적 두 모델이 동시에 발전하도록 자극
	- 정교하고 현실적인 데이터 생성

#### 생성자와 판별자의 역할
- **생성자** : `랜덤한 노이즈 벡터` -> `실제와 유사한 이미지`
- **판별자** : `생성자 이미지` + `실제 이미지` -> `구별`

- 반복 -> 서로의 성능을 향상
	- **생성자는 판별자가 구분 못하는 데이터 생성**

#### GAN의 기계학습에서의 위치와 의미
- 생성 모델링에서 중요 역할
	- 데이터 분포 학습 -> 새로운 데이터 생성
- GAN은 비지도 학습
	- 레이블 X여도 학습
	- 대량의 비레이블 상태에서 Good (이미지 생성, 데이터 증강, 스타일 변환)

<hr>

### GAN의 학습 과정
- 두 신경망의 경쟁
	- 더 정교한 생성 이미지 vs 더 정확한 구별 학습

#### 학습 단계
1. **랜덤 노이즈 생성** : 생성자에게 랜덤한 노이즈 벡터 입력
2. **가짜 이미지 생성** : 생성자는 가짜 이미지 생성
3. **실제 및 가짜 이미지 생성** : 실제+가짜 이미지 섞어서 판별자에 입력
4. **판별자 학습** : 실제 1, 가짜 0으로 구별하도록 학습
5. **생성자 학습** : 생성자는 더 정교하게 생성하도록 학습

#### 비유 : 위조지폐범 vs 경찰관
- 서로 속이고/판별하기 위해 서로 경쟁-발전

#### 게임 이론과 균형
- 만약 두 네트워크가 최고의 실력 갖추면? -> 승률 50:50 (엄대엄)
- 균형 상태 : **내쉬 균형**
	- 생성자는 판별자를 완벽히 속임 = 리얼 데이터를 만듦
	- 판별자는 데이터 구별 불가

<hr>

### 훈련 세팅 및 절차
- 세팅할 것
	1. 훈련 데이터
	2. 각 네트워크 손실 함수
	3. 최종 손실 계산 방법

#### 구체적인 데이터 세팅 방법
- 필요한 것 : 진짜 이미지, 가짜 이미지, 이미지 레이블
	- **진짜 이미지**
		- 실제 이미지 (크롤링, 공개 데이터셋)
	- **가짜 이미지**
		- 생성자가 생성한 이미지
		- `랜덤 노이즈 벡터` -> `가짜 이미지`
		- 노이즈 벡터는 정규 분포 따름
	- **참조 레이블**
		- 진짜 : 1, 가짜 : 0

#### 판별자 훈련
- 정리한 데이터 바탕으로 판별자 훈련
- 보통 진짜/가짜 5:5 비율로 섞음
	- 실제 이미지 -> 1 가깝게
	- 생성 이미지 -> 0 가깝게

#### 생성자 훈련
- 직접은 불가, 생성자를 속일 수 있도록 학습
- 생성 이미지 최종 Label 값을 모두 1로 만들도록 진행

#### 각 네트워크별 손실 값 계산 방법
- 생성자/판별자 각각의 손실 함수 정의
- **주요 개념, 용어**
	- `x` : 실제 데이터 포인트
	- `z` : 잠재 공간에 샘플링된 랜덤 노이즈 벡터 (정규 분포)
	- `G(z)` : 생성자 G가 랜덤 노이즈 `z`로 생성한 가짜 데이터
	- `D(x)` : 판별자 D가 `x`에 대해 출력하는 값 = 데이터가 진짜일 확률

##### 판별자의 손실 함수
- 실제/가짜 이미지 구분하는 성능 평가
- 입력이 real / fake인 경우 구분
	- **최종 판별자 손실함수 = 두 경우의 합**

- 입력이
	- 진짜인 경우 L_real
	- 가짜인 경우 L_fake

- **손실 함수 L = L_real + L_fake**
	- L_real : 실제 데이터 `x`에 대해 1에 가깝게 출력
	- L_fake : 가짜 데이터 `G(z)`에 대해 0에 가깝게 출력

##### 생성자의 손실 함수
- 판별자를 속이는 성능 평가
- 생성자가 생성한 가짜 데이터 `G(z)`에 대해 판별자가 1에 가까운 값 출력하도록 함
- 손실 값 케이스 - 가짜 이미지를...
	- 진짜로 판단 : **L ↓**
	- 가짜로 판단 : **L ↑**

##### 최종 손실 계산
- GAN 학습은 다음 과정 반복
	1. **판별자 학습**
		- 진짜 이미지 입력 손실 계산 + 가짜 이미지 입력 손실 계산
		- 두 손실 값 합산하여 판별자 업데이트
	2. **생성자 학습**
		- 랜덤 노이즈 입력 -> 가짜 이미지 생성
		- 판별자에 가짜 이미지 입력 -> 손실 계산 -> 생성자 업데이트

<hr>

### 최종 훈련 후의 활용
- GAN의 학습이 끝나면 생성자/판별자 중 활용할 것 결정
	- **보통 생성자 최종 활용**
		- 이미지 생성, 데이터 증강, 스타일 변환
	- **판별자 활용**
		- 주로 생성자 성능 평가에 활용

### GAN의 장단점
- **장점**
	- 고품질 이미지 생성
	- 다양한 응용 : 이미지 생성, 데이터 증강, 스타일 변환
- **단점**
	- **학습 불안정성** : GAN의 학습은 불안정할 수 잇음, 적절한 하이퍼파라미터 설정 필요
	- **모드 붕괴** : 특정 유형의 이미지만 생성, 다양성 X
	- **손실값 모니터링의 어려움** : GAN의 손실 함수 모니터링 힘듦

### 결론
- GAN은 딥러닝에서 매우 중요한 생성 모델 -> 다양한 응용 가능성
- 많은 변형도 존재 -> **CGAN**, **Pix2Pix**, **CycleGAN**, StyleGAN, BigGAN